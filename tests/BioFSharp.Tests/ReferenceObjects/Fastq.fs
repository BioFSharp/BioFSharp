namespace BioFSharp.Tests.ReferenceObjects

module Fastq =

    open BioFSharp.Nucleotides
    open BioFSharp.FileFormats.Fastq

    let testString_one_entry = """@SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=72
GGGTGATGGCCGCTGCCGATGGCGTCAAATCCCACCAAGTTACCCTTAACAACTTAAGGGTTTTCAAATAGA
+SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=72
IIIIIIIIIIIIIIIIIIIIIIIIIIIIII9IG9ICIIIIIIIIIIIIIIIIIIIIDIIIIIII>IIIIII/
"""                                 .ReplaceLineEndings()

    let testString_two_entries = """@SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=72
GGGTGATGGCCGCTGCCGATGGCGTCAAATCCCACCAAGTTACCCTTAACAACTTAAGGGTTTTCAAATAGA
+SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=72
IIIIIIIIIIIIIIIIIIIIIIIIIIIIII9IG9ICIIIIIIIIIIIIIIIIIIIIDIIIIIII>IIIIII/
@SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=72
GGGTGATGGCCGCTGCCGATGGCGTCAAATCCCACCAAGTTACCCTTAACAACTTAAGGGTTTTCAAATAGA
+SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=72
IIIIIIIIIIIIIIIIIIIIIIIIIIIIII9IG9ICIIIIIIIIIIIIIIIIIIIIDIIIIIII>IIIIII/
"""                                 .ReplaceLineEndings()

    /// get Phred quality score (Phred+33)
    let charToPhred33 (s:seq<char>) = s |> Seq.map (fun c -> int c - 33)

    /// encode Phred quality score (Phred+33)
    let phred33ToChar (q:int) =
        char (q + 33)

    let expectedFastqItem =
        FastqItem.create
            "SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=72"
            [G;G;G;T;G;A;T;G;G;C;C;G;C;T;G;C;C;G;A;T;G;G;C;G;T;C;A;A;A;T;C;C;C;A;C;C;A;A;G;T;T;A;C;C;C;T;T;A;A;C;A;A;C;T;T;A;A;G;G;G;T;T;T;T;C;A;A;A;T;A;G;A]
            "SRR001666.1 071112_SLXA-EAS1_s_7:5:1:817:345 length=72"
            [40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;24;40;38;24;40;34;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;40;35;40;40;40;40;40;40;40;29;40;40;40;40;40;40;14]
