<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Clustal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="An open source bioinformatics toolbox written in F#. <https://csbiology.github.io/BioFSharp/>"/>
    <meta name="author" content="Timo MÃ¼hlhaus"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>
    <meta http-equiv="X-UA-Compatible" content="IE=11" >
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link type="text/css" rel="stylesheet" href="/BioFSharp/content/style.css" /> <!--/BioFSharp-->
    <link type="text/css" rel="stylesheet" href="/BioFSharp/style/CSBstyle.css" /> <!--/BioFSharp-->
    <script type="text/javascript" src="/BioFSharp/content/tips.js"></script> <!--/BioFSharp-->
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
	<body>
		<div class="container">
		  <div class="masthead">
			<ul class="nav nav-pills pull-right">
			  <li><a href="http://fsharp.org">fsharp.org</a></li>
			  <li><a href="https://github.com/CSBiology/BioFSharp">github page</a></li>
			</ul>
			<h3 class="muted"><a href="/BioFSharp/index.html">BioFSharp</a></h3>
		  </div>
		  <hr />
		  <div class="row">
			<div class="span9" id="main">
			  
<table class="HeadAPI">
<td class="Head"><h1>Clustal format</h1></td>
<td class="API">
    <a id="APILink" href="https://csbiology.github.io/BioFSharp/reference/biofsharp-io-clustal.html" >&#128194;View module documentation</a>
</td>
</table>
<p>The clustal file format is the standard output format of alignments generated by clustal algorithms (Clustal W, Clustal Omega...). Usually the first line is a one line header, including the clustal version and possibly other information. This is followed by at least one empty line.<br />
Afterwards there are blocks of sequence data. The amount of blocks depends on the length of the sequences. Every line in those blocks consists of:</p>
<ol>
<li>Name of Sequence</li>
<li>White space</li>
<li>Up to 60 characters of the sequence, where <code>-</code> denotes gaps</li>
<li>(not necessarily) white space and a number stating the cumulative amount of non gap characters of the given sequence up to this point</li>
</ol>
<p>The last line of every block is a sequence of symbols denoting the degree of conservation for this column. (<code>*</code> = identical residues, <code>:</code> = conserved substitution, <code>.</code> = semi-conserved substitutions, <code></code> = no match)</p>
<p>Blocks are separated by at least one empty line.</p>
<p>As an example, the peptide sequences of the large chain subunit of RuBisCO of different organisms was aligned with Clustal Omega:<br />
<br>
<button type="button" class="btn" data-toggle="collapse" data-target="#clustalExample">Show/Hide example</button>
<div id="clustalExample" class="collapse clustalExample ">
<pre>
CLUSTAL O(1.2.4) multiple sequence alignment<br>
<br>
<br>
C_reinhardtii      MVPQTETKAGAGFKAGVKDYRLTYYTPDYVVRDTDILAAFRMTPQLGVPPEECGAAVAAE<br>
N_tabacum          MSPQTETKASVGFKAGVKEYKLTYYTPEYQTKDTDILAAFRVTPQPGVPPEEAGAAVAAE<br>
A_thaliana         MSPQTETKASVGFKAGVKEYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE<br>
O_sativa           MSPQTETKASVGFKAGVKDYKLTYYTPEYETKDTDILAAFRVTPQPGVPPEEAGAAVAAE<br>
* *******..*******:*:******:* .:*********:*** ******.*******<br>
<br>
C_reinhardtii      SSTGTWTTVWTDGLTSLDRYKGRCYDIEPVPGEDNQYIAYVAYPIDLFEEGSVTNMFTSI<br>
N_tabacum          SSTGTWTTVWTDGLTSLDRYKGRCYRIERVVGEKDQYIAYVAYPLDLFEEGSVTNMFTSI<br>
A_thaliana         SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVPGEETQFIAYVAYPLDLFEEGSVTNMFTSI<br>
O_sativa           SSTGTWTTVWTDGLTSLDRYKGRCYHIEPVVGEDNQYIAYVAYPLDLFEEGSVTNMFTSI<br>
************************* ** * **. *:*******:***************<br>
<br>
C_reinhardtii      VGNVFGFKALRALRLEDLRIPPAYVKTFVGPPHGIQVERDKLNKYGRGLLGCTIKPKLGL<br>
N_tabacum          VGNVFGFKALRALRLEDLRIPPAYVKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL<br>
A_thaliana         VGNVFGFKALAALRLEDLRIPPAYTKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL<br>
O_sativa           VGNVFGFKALRALRLEDLRIPPTYSKTFQGPPHGIQVERDKLNKYGRPLLGCTIKPKLGL<br>
********** ***********:* *** ****************** ************<br>
<br>
C_reinhardtii      SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFVAEAIYKAQAETGEVKGHYL<br>
N_tabacum          SAKNYGRAVYECLRGGLDFTKDDENVNSQPF-RWRDRFLFCAEALYKAQAETGEIKGHYL<br>
A_thaliana         SAKNYGRAVYECLRGGLDFTKDDENVNSQPFMRWRDRFLFCAEAIYKSQAETGEIKGHYL<br>
O_sativa           SAKNYGRACYECLRGGLDFTKDDENVNSQPFMRWRDRFVFCAEAIYKSQAETGEIKGHYL<br>
******** ********************** ******:* ***:**:******:*****<br>
<br>
C_reinhardtii      NATAGTCEEMMKRAVCAKELGVPIIMHDYLTGGFTANTSLAIYCRDNGLLLHIHRAMHAV<br>
N_tabacum          NATAGTCEEMIKRAVFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV<br>
A_thaliana         NATAGTCEEMIKRAVFARELGVPIVMHDYLTGGFTANTSLSHYCRDNGLLLHIHRAMHAV<br>
O_sativa           NATAGTCEEMIKRAVFARELGVPIVMHDYLTGGFTANTSLAHYCRDNGLLLHIHRAMHAV<br>
**********:**** *:******:***************: ******************<br>
<br>
C_reinhardtii      IDRQRNHGIHFRVLAKALRMSGGDHLHSGTVVGKLEGEREVTLGFVDLMRDDYVEKDRSR<br>
N_tabacum          IDRQKNHGIHFRVLAKALRMSGGDHIHSGTVVGKLEGERDITLGFVDLLRDDFVEQDRSR<br>
A_thaliana         IDRQKNHGMHFRVLAKALRLSGGDHIHAGTVVGKLEGDRESTLGFVDLLRDDYVEKDRSR<br>
O_sativa           IDRQKNHGMHFRVLAKALRMSGGDHIHAGTVVGKLEGEREMTLGFVDLLRDDFIEKDRAR<br>
****:***:**********:*****:*:*********:*: *******:***::*:**:*<br>
<br>
C_reinhardtii      GIYFTQDWCSMPGVMPVASGGIHVWHMPALVEIFGDDACLQFGGGTLGHPWGNAPGAAAN<br>
N_tabacum          GIYFTQDWVSLPGVLPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN<br>
A_thaliana         GIFFTQDWVSLPGVLPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAVAN<br>
O_sativa           GIFFTQDWVSMPGVIPVASGGIHVWHMPALTEIFGDDSVLQFGGGTLGHPWGNAPGAAAN<br>
**:***** *:***:***************.******: ******************.**<br>
<br>
C_reinhardtii      RVALEACTQARNEGRDLAREGGDVIRSACKWSPELAAACEVWKEIKFEFDTIDKL----<br>
N_tabacum          RVALEACVKARNEGRDLAQEGNEIIREACKWSPELAAACEVWKEIVFNFAAVDVLDK--<br>
A_thaliana         RVALEACVQARNEGRDLAVEGNEIIREACKWSPELAAACEVWKEITFNFPTIDKLDGQE<br>
O_sativa           RVALEACVQARNEGRDLAREGNEIIRSACKWSPELAAACEIWKAIKFEFEPVDKLDS--<br>
*******.:********* **.::**.*************:** * *:*  :* *<br />
</pre></p>
<button type="button" class="btn" data-toggle="collapse" data-target="#clustalExample">Hide again</button>  
</div>
<h2><a name="Reading-Clustal-files" class="anchor" href="#Reading-Clustal-files">Reading Clustal files</a></h2>
<p>To read Clustal files, just use the ofFile function located in the Clustal module of the BioFSharp.IO namespace. It does not need anything but the file path and will return the alignment as <code>Alignment</code>.<br />
Keep in mind that if your clustal file containts numbers representing the character count at the line end. They and their line space will be included in the Alignment. Make sure to filter them out if not needed.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="id">BioFSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="id">IO</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="id">fileDir</span> <span class="o">=</span> <span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;/data/&quot;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="id">path</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="id">fileDir</span> <span class="o">+</span> <span class="s">&quot;clustalExample.asn&quot;</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="id">clustalAlignment</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="m">Clustal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="id">ofFile</span> <span onmouseout="hideTip(event, 'fs4', 9)" onmouseover="showTip(event, 'fs4', 9)" class="id">path</span>
</code></pre></td>
</tr>
</table>
<pre>
val clustalAlignment :
  BioFSharp.Alignment.Alignment<Clustal.NamedSequence,Clustal.AlignmentInfo> =
  {MetaData = {Header = &lt;seq&gt;;
               ConservationInfo = &lt;seq&gt;;};
   AlignedSequences =
    [{Name = "C_reinhardtii";
      Sequence = &lt;seq&gt;;}; {Name = "N_tabacum";
                           Sequence = &lt;seq&gt;;}; {Name = "A_thaliana";
                                                Sequence = &lt;seq&gt;;};
     {Name = "O_sativa";
      Sequence = &lt;seq&gt;;}];}
</pre>
<h2><a name="Writing-Clustal-files" class="anchor" href="#Writing-Clustal-files">Writing Clustal files</a></h2>
<p>For writing clustal files you can use the <code>toFile</code> function. It takes a path and the alignment. The type of alignment is the same as the result of the reading function. You can see this above.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="id">outputPath</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 11)" onmouseover="showTip(event, 'fs3', 11)" class="id">fileDir</span> <span class="o">+</span> <span class="s">&quot;clustalOutputExample.asn&quot;</span>
</code></pre></td>
</tr>
</table>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="m">Clustal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="id">toFileWithOverWrite</span> <span onmouseout="hideTip(event, 'fs8', 14)" onmouseover="showTip(event, 'fs8', 14)" class="id">outputPath</span> <span onmouseout="hideTip(event, 'fs5', 15)" onmouseover="showTip(event, 'fs5', 15)" class="id">clustalAlignment</span>
</code></pre></td>
</tr>
</table>

<div class="tip" id="fs1">namespace BioFSharp</div>
<div class="tip" id="fs2">namespace BioFSharp.IO</div>
<div class="tip" id="fs3">val fileDir : string</div>
<div class="tip" id="fs4">val path : string</div>
<div class="tip" id="fs5">val clustalAlignment : BioFSharp.Alignment.Alignment&lt;BioFSharp.BioID.TaggedSequence&lt;string,char&gt;,Clustal.AlignmentInfo&gt;</div>
<div class="tip" id="fs6">module Clustal<br /><br />from BioFSharp.IO</div>
<div class="tip" id="fs7">val ofFile : path:string -&gt; BioFSharp.Alignment.Alignment&lt;BioFSharp.BioID.TaggedSequence&lt;string,char&gt;,Clustal.AlignmentInfo&gt;</div>
<div class="tip" id="fs8">val outputPath : string</div>
<div class="tip" id="fs9">val toFileWithOverWrite : path:string -&gt; alignment:BioFSharp.Alignment.Alignment&lt;BioFSharp.BioID.TaggedSequence&lt;string,char&gt;,Clustal.AlignmentInfo&gt; -&gt; unit</div>

			</div>
			<div class="span3" >
			  <img src="/BioFSharp/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
				<ul class="nav nav-list" id="menu" style="margin-top: 20px;">
					<li class="nav-header">BioFSharp</li>
					<li><a href="/BioFSharp/index.html">Home page</a></li>
					<li class="divider"></li>
					<li><a href="/BioFSharp/Introduction.html">Getting started</a></li>

					
					<li class="nav-header">BioFSharp core</li>
					<li><a href="/BioFSharp/Formula.html">Formula</a></li>
					<li>
						<a href="/BioFSharp/BioItem.html">BioItems</a>
					</li>
					<li><a href="/BioFSharp/BioCollections.html">BioCollections</a></li>
					<li><a href="/BioFSharp/AminoProperties.html">Peptide Properties</a></li>
					<li class="nav-header">Algorithm</li>
					<li><a href="/BioFSharp/Alignment.html">Alignment</a></li>
					<li><a href="/BioFSharp/ClustalOWrapper.html">Clustal Omega</a></li>
					<li><a href="/BioFSharp/MotiveSearch.html">Motive search</a></li>
					<li><a href="/BioFSharp/BlastWrapper.html">NCBI-Blast</a></li>
					<li>
						<a href="/BioFSharp/StringMatching.html">Pattern Queries</a>
					</li>
					<li class="nav-header">File I/O</li>
					<li>
						<a href="/BioFSharp/Clustal.html">Clustal</a>
						<ul class="nav nav-list">
							<li><a href="/BioFSharp/Clustal.html#Clustal-format">Format</a></li>
							<li><a href="/BioFSharp/Clustal.html#Reading-Clustal-files">Reading</a></li>
							<li><a href="/BioFSharp/Clustal.html#Writing-Clustal-files">Writing</a></li>
						</ul>
					</li>
					<li><a href="/BioFSharp/CSV.html">CSV / Tabular</a></li>
					<li>
						<a href="/BioFSharp/FastA.html">FastA</a>
					</li>   
					<li><a href="/BioFSharp/FastQ.html">FastQ</a></li>
					<li>
						<a href="/BioFSharp/GenBank.html">GenBank</a>
					</li>  
					<li>
						<a href="/BioFSharp/GFF3.html">GFF3</a>
					</li>    
					<li>
						<a href="/BioFSharp/Newick.html">Newick</a>
					</li>                
					<li><a href="/BioFSharp/Obo.html">Obo ontology format</a></li>
					<li class="nav-header">Web I/O</li>
					<li><a href="/BioFSharp/UniProt.html">UniProt</a></li>
					<li><a href="/BioFSharp/BioDB.html">BioDB</a></li>
					<li class="nav-header">Biostatistics</li>
					<li><a href="/BioFSharp/GESA.html">Ontology enrichment</a></li>
					<li class="nav-header">Biovisualization</li>
					<li><a href="/BioFSharp/WebLogo.html">Web logo</a></li>
					<li class="nav-header">GPU Computing</li>
					<li><a href="/BioFSharp/ParallelAlignment.html">Sequence Alignment</a></li>
					<li class="nav-header">Documentation</li>
					<li><a href="/BioFSharp/reference/index.html">API Reference</a></li>


					
				</ul>
			</div>
		  </div>
		</div>
		<a href="https://github.com/CSBiology/BioFSharp"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
	  </body>
  </html>
