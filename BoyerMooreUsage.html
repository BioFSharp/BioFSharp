<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Introducing the Boyer Moore string search algorithm
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="BioFSharp aims to be a user-friendly library for Bioinformatics written in F# as the successor official of FSharpBio."/>
    <meta name="author" content="Timo MÃ¼hlhaus"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>
    <link type="text/css" rel="stylesheet" href="/BioFSharp/style/CSBstyle.css" />
    <link type="text/css" rel="stylesheet" href="/BioFSharp/content/style.css" />
    <script type="text/javascript" src="/BioFSharp/content/tips.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/CSBiology/BioFSharp">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/BioFSharp/index.html">BioFSharp</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Introducing-the-Boyer-Moore-string-search-algorithm" class="anchor" href="#Introducing-the-Boyer-Moore-string-search-algorithm">Introducing the Boyer Moore string search algorithm</a></h1>
<p>This part of the documentation gives a short introduction into the Boyer Moore string search algorithm which is particulary desined to work on IBioItems.This algorithm searches a query within a longer source. In using two arrays that are created using the bad character rule and the good suffix heuristics the best shifting value is determined. This accounts for higher shifts which prevents unnecessary comparisons to save time.</p>
<p>The following code will return an array created out of all the proteins that are contained in the fasta file. First, the Symbols in the file get converted
into amino acids and then they get concatenated and transformed into an array.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="i">chlamyproteins</span> <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 14)" onmouseover="showTip(event, 'fs12', 14)" class="f">converter</span> <span onmouseout="hideTip(event, 'fs13', 15)" onmouseover="showTip(event, 'fs13', 15)" class="i">letters</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs14', 16)" onmouseover="showTip(event, 'fs14', 16)" class="t">BioList</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 17)" onmouseover="showTip(event, 'fs15', 17)" class="t">BioList</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs16', 18)" onmouseover="showTip(event, 'fs16', 18)" class="t">AminoAcid</span><span class="o">&gt;</span> <span class="o">=</span> 
        <span onmouseout="hideTip(event, 'fs13', 19)" onmouseover="showTip(event, 'fs13', 19)" class="i">letters</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 20)" onmouseover="showTip(event, 'fs17', 20)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 21)" onmouseover="showTip(event, 'fs18', 21)" class="f">map</span> ( <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs19', 22)" onmouseover="showTip(event, 'fs19', 22)" class="i">x</span> <span class="k">-&gt;</span> <span class="k">match</span> (<span onmouseout="hideTip(event, 'fs2', 23)" onmouseover="showTip(event, 'fs2', 23)" class="i">BioFSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 24)" onmouseover="showTip(event, 'fs7', 24)" class="t">AminoAcids</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 25)" onmouseover="showTip(event, 'fs20', 25)" class="f">charToParsedAminoAcidChar</span> <span onmouseout="hideTip(event, 'fs19', 26)" onmouseover="showTip(event, 'fs19', 26)" class="i">x</span>) <span class="k">with</span>
                                  | <span onmouseout="hideTip(event, 'fs21', 27)" onmouseover="showTip(event, 'fs21', 27)" class="t">ParsedAminoAcidChar</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 28)" onmouseover="showTip(event, 'fs22', 28)" class="p">StandardCodes</span>  <span onmouseout="hideTip(event, 'fs23', 29)" onmouseover="showTip(event, 'fs23', 29)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs23', 30)" onmouseover="showTip(event, 'fs23', 30)" class="i">v</span>
                                  | <span onmouseout="hideTip(event, 'fs21', 31)" onmouseover="showTip(event, 'fs21', 31)" class="t">ParsedAminoAcidChar</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 32)" onmouseover="showTip(event, 'fs24', 32)" class="p">AmbiguityCodes</span> <span onmouseout="hideTip(event, 'fs23', 33)" onmouseover="showTip(event, 'fs23', 33)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs23', 34)" onmouseover="showTip(event, 'fs23', 34)" class="i">v</span>
                                  | <span onmouseout="hideTip(event, 'fs21', 35)" onmouseover="showTip(event, 'fs21', 35)" class="t">ParsedAminoAcidChar</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 36)" onmouseover="showTip(event, 'fs25', 36)" class="p">GapTer</span>         <span onmouseout="hideTip(event, 'fs23', 37)" onmouseover="showTip(event, 'fs23', 37)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs23', 38)" onmouseover="showTip(event, 'fs23', 38)" class="i">v</span>
                                  | <span onmouseout="hideTip(event, 'fs21', 39)" onmouseover="showTip(event, 'fs21', 39)" class="t">ParsedAminoAcidChar</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 40)" onmouseover="showTip(event, 'fs26', 40)" class="p">NoAAChar</span>       <span onmouseout="hideTip(event, 'fs27', 41)" onmouseover="showTip(event, 'fs27', 41)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs28', 42)" onmouseover="showTip(event, 'fs28', 42)" class="f">failwith</span> <span class="s">&quot;No AA Char given&quot;</span>)
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 43)" onmouseover="showTip(event, 'fs17', 43)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 44)" onmouseover="showTip(event, 'fs29', 44)" class="f">toList</span>

    <span onmouseout="hideTip(event, 'fs30', 45)" onmouseover="showTip(event, 'fs30', 45)" class="t">FileIO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 46)" onmouseover="showTip(event, 'fs31', 46)" class="f">readFile</span> (<span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;/data/Proteins.fasta&quot;</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs32', 47)" onmouseover="showTip(event, 'fs32', 47)" class="t">FastA</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 48)" onmouseover="showTip(event, 'fs33', 48)" class="f">fromFileEnumerator</span> (<span onmouseout="hideTip(event, 'fs12', 49)" onmouseover="showTip(event, 'fs12', 49)" class="f">converter</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 50)" onmouseover="showTip(event, 'fs17', 50)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 51)" onmouseover="showTip(event, 'fs18', 51)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs34', 52)" onmouseover="showTip(event, 'fs34', 52)" class="i">item</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs34', 53)" onmouseover="showTip(event, 'fs34', 53)" class="i">item</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 54)" onmouseover="showTip(event, 'fs35', 54)" class="i">Sequence</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 55)" onmouseover="showTip(event, 'fs17', 55)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 56)" onmouseover="showTip(event, 'fs36', 56)" class="f">toArray</span>)
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 57)" onmouseover="showTip(event, 'fs17', 57)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 58)" onmouseover="showTip(event, 'fs37', 58)" class="f">concat</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 59)" onmouseover="showTip(event, 'fs17', 59)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 60)" onmouseover="showTip(event, 'fs36', 60)" class="f">toArray</span>
</code></pre></td>
</tr>
</table>
<p>The following code will return the first occurence of the searched query within the source.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs2', 61)" onmouseover="showTip(event, 'fs2', 61)" class="i">BioFSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 62)" onmouseover="showTip(event, 'fs10', 62)" class="i">Algorithm</span><span class="o">.</span><span class="i">BoyerMoore</span><span class="o">.</span><span class="i">findFirst</span> <span onmouseout="hideTip(event, 'fs11', 63)" onmouseover="showTip(event, 'fs11', 63)" class="i">chlamyproteins</span> <span onmouseout="hideTip(event, 'fs11', 64)" onmouseover="showTip(event, 'fs11', 64)" class="i">chlamyproteins</span><span class="o">.</span>[<span class="n">16988..</span><span class="n">17978</span>]
</code></pre></td>
</tr>
</table>
<p>The following code will return the first occurence of the query after a given staring point.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs2', 65)" onmouseover="showTip(event, 'fs2', 65)" class="i">BioFSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 66)" onmouseover="showTip(event, 'fs10', 66)" class="i">Algorithm</span><span class="o">.</span><span class="i">BoyerMoore</span><span class="o">.</span><span class="i">findFrom</span> <span class="n">7</span> <span onmouseout="hideTip(event, 'fs11', 67)" onmouseover="showTip(event, 'fs11', 67)" class="i">chlamyproteins</span> <span onmouseout="hideTip(event, 'fs11', 68)" onmouseover="showTip(event, 'fs11', 68)" class="i">chlamyproteins</span><span class="o">.</span>[<span class="n">16988..</span><span class="n">17978</span>]
</code></pre></td>
</tr>
</table>
<p>The following code will return the all the occurence of the query within the given source.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs2', 69)" onmouseover="showTip(event, 'fs2', 69)" class="i">BioFSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 70)" onmouseover="showTip(event, 'fs10', 70)" class="i">Algorithm</span><span class="o">.</span><span class="i">BoyerMoore</span><span class="o">.</span><span class="i">findAll</span> <span onmouseout="hideTip(event, 'fs11', 71)" onmouseover="showTip(event, 'fs11', 71)" class="i">chlamyproteins</span> <span onmouseout="hideTip(event, 'fs11', 72)" onmouseover="showTip(event, 'fs11', 72)" class="i">chlamyproteins</span><span class="o">.</span>[<span class="n">16988..</span><span class="n">17978</span>]
</code></pre></td>
</tr>
</table>

<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace BioFSharp</div>
<div class="tip" id="fs3">namespace BioFSharp.IO</div>
<div class="tip" id="fs4">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="tip" id="fs5">namespace FSharp.Care</div>
<div class="tip" id="fs6">namespace FSharp.Care.IO</div>
<div class="tip" id="fs7">module AminoAcids<br /><br />from BioFSharp</div>
<div class="tip" id="fs8">module Nucleotides<br /><br />from BioFSharp</div>
<div class="tip" id="fs9">module AminoAcidSymbols<br /><br />from BioFSharp</div>
<div class="tip" id="fs10">namespace BioFSharp.Algorithm</div>
<div class="tip" id="fs11">val chlamyproteins : AminoAcid []<br /><br />Full name: BoyerMooreUsage.chlamyproteins</div>
<div class="tip" id="fs12">val converter : (seq&lt;char&gt; -&gt; BioList.BioList&lt;AminoAcid&gt;)</div>
<div class="tip" id="fs13">val letters : seq&lt;char&gt;</div>
<div class="tip" id="fs14">module BioList<br /><br />from BioFSharp</div>
<div class="tip" id="fs15">type BioList&lt;&#39;a (requires &#39;a :&gt; IBioItem)&gt; = &#39;a list<br /><br />Full name: BioFSharp.BioList.BioList&lt;_&gt;</div>
<div class="tip" id="fs16">type AminoAcid =<br />&#160;&#160;| Ala<br />&#160;&#160;| Cys<br />&#160;&#160;| Asp<br />&#160;&#160;| Glu<br />&#160;&#160;| Phe<br />&#160;&#160;| Gly<br />&#160;&#160;| His<br />&#160;&#160;| Ile<br />&#160;&#160;| Lys<br />&#160;&#160;| Leu<br />&#160;&#160;...<br />&#160;&#160;interface IBioItem<br />&#160;&#160;static member op_Explicit : value:#IBioItem -&gt; int<br />&#160;&#160;static member op_Explicit : value:#IBioItem -&gt; byte<br /><br />Full name: BioFSharp.AminoAcids.AminoAcid</div>
<div class="tip" id="fs17">Multiple items<br />module Seq<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type Seq =<br />&#160;&#160;static member fromFile : filePath:string -&gt; seq&lt;string&gt;<br />&#160;&#160;static member fromFileWithCsvSchema : filePath:string * separator:char * firstLineHasHeader:bool * ?skipLines:int * ?skipLinesBeforeHeader:int * ?schemaMode:SchemaMode -&gt; seq&lt;&#39;schema&gt;<br />&#160;&#160;static member fromFileWithSep : separator:char -&gt; filePath:string -&gt; seq&lt;string []&gt;<br />&#160;&#160;static member toCSV : separator:string -&gt; header:bool -&gt; data:seq&lt;&#39;a&gt; -&gt; seq&lt;string&gt;<br />&#160;&#160;static member write : path:string -&gt; data:seq&lt;&#39;a&gt; -&gt; unit<br />&#160;&#160;static member writeOrAppend : path:string -&gt; data:seq&lt;&#39;a&gt; -&gt; unit<br /><br />Full name: FSharp.Care.IO.SeqIO.Seq</div>
<div class="tip" id="fs18">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs19">val x : char</div>
<div class="tip" id="fs20">val charToParsedAminoAcidChar : c:char -&gt; ParsedAminoAcidChar<br /><br />Full name: BioFSharp.AminoAcids.charToParsedAminoAcidChar</div>
<div class="tip" id="fs21">type ParsedAminoAcidChar =<br />&#160;&#160;| StandardCodes of AminoAcid<br />&#160;&#160;| AmbiguityCodes of AminoAcid<br />&#160;&#160;| GapTer of AminoAcid<br />&#160;&#160;| NoAAChar of char<br /><br />Full name: BioFSharp.AminoAcids.ParsedAminoAcidChar</div>
<div class="tip" id="fs22">union case ParsedAminoAcidChar.StandardCodes: AminoAcid -&gt; ParsedAminoAcidChar</div>
<div class="tip" id="fs23">val v : AminoAcid</div>
<div class="tip" id="fs24">union case ParsedAminoAcidChar.AmbiguityCodes: AminoAcid -&gt; ParsedAminoAcidChar</div>
<div class="tip" id="fs25">union case ParsedAminoAcidChar.GapTer: AminoAcid -&gt; ParsedAminoAcidChar</div>
<div class="tip" id="fs26">union case ParsedAminoAcidChar.NoAAChar: char -&gt; ParsedAminoAcidChar</div>
<div class="tip" id="fs27">val v : char</div>
<div class="tip" id="fs28">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs29">val toList : source:seq&lt;&#39;T&gt; -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toList</div>
<div class="tip" id="fs30">module FileIO<br /><br />from FSharp.Care.IO</div>
<div class="tip" id="fs31">val readFile : file:string -&gt; seq&lt;string&gt;<br /><br />Full name: FSharp.Care.IO.FileIO.readFile</div>
<div class="tip" id="fs32">module FastA<br /><br />from BioFSharp.IO</div>
<div class="tip" id="fs33">val fromFileEnumerator : converter:(seq&lt;char&gt; -&gt; &#39;a) -&gt; fileEnumerator:seq&lt;string&gt; -&gt; seq&lt;FastA.FastaItem&lt;&#39;a&gt;&gt;<br /><br />Full name: BioFSharp.IO.FastA.fromFileEnumerator</div>
<div class="tip" id="fs34">val item : FastA.FastaItem&lt;BioList.BioList&lt;AminoAcid&gt;&gt;</div>
<div class="tip" id="fs35">FastA.FastaItem.Sequence: BioList.BioList&lt;AminoAcid&gt;</div>
<div class="tip" id="fs36">val toArray : source:seq&lt;&#39;T&gt; -&gt; &#39;T []<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toArray</div>
<div class="tip" id="fs37">val concat : sources:seq&lt;#seq&lt;&#39;T&gt;&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.concat</div>

        </div>
        <div class="span3" >
          <img src="/BioFSharp/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
            <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
                <li class="nav-header">BioFSharp</li>
                <li><a href="/BioFSharp/index.html">Home page</a></li>
                <li class="divider"></li>
                <li><a href="http://nuget.org/packages/BioFSharp">Get Library via NuGet</a></li>
                <li><a href="http://github.com/CSBiology/BioFSharp">Source Code on GitHub</a></li>
                <li><a href="/BioFSharp/license.html">License</a></li>
                <li><a href="/BioFSharp/release-notes.html">Release Notes</a></li>
                <li class="divider"></li>
                <li class="nav-header">Getting started</li>
                <li><a href="/BioFSharp/Introduction.html">Introduction</a></li>
                <li><a href="/BioFSharp/LibraryStructure.html">Library Structure</a></li>
                <li class="nav-header">Data Structures</li>
                <li><a href="/BioFSharp/Elements.html">Elements</a></li>
                <li><a href="/BioFSharp/Isotopes.html">Isotopes</a></li>
                <li><a href="/BioFSharp/Formula.html">Formula</a></li>
                <li><a href="/BioFSharp/Nucleotides.html">Nucleotides</a></li>
                <li><a href="/BioFSharp/Aminoacids.html">Aminoacids</a></li>
                <li>
                    <a href="/BioFSharp/BioCollections.html">BioCollections</a>
                </li>
                <li><a href="/BioFSharp/BioID.html">BioID</a></li>
                <li class="nav-header">Pattern Queries</li>
                <li><a href="/BioFSharp/Alignment.html">Alignment</a></li>
                <li><a href="/BioFSharp/BlastWrapper.html">Use NCBI-Blast</a></li>
                <li>
                    <a href="/BioFSharp/StringMatching.html">String matching algorithms</a>
                </li>
                <li class="nav-header">File Parsing</li>
                <li>
                    <a href="/BioFSharp/Readers.html">I/O</a>
                </li>
                <li class="nav-header">Charting & Visualization</li>
                <li><a href="/BioFSharp/Plotly.html">Charting with Plotly</a></li>
                <li class="nav-header">Documentation</li>
                <li><a href="/BioFSharp/reference/index.html">API Reference</a></li>
                <li class="nav-header">Our other projects</li>
                <li><a href="https://github.com/CSBiology/FSharp.Stats">FSharp.Stats</a></li>
                <li><a href="https://github.com/CSBiology/FSharp.Care">FSharp.Care</a></li>
                <li><a href="https://github.com/CSBiology/FSharp.FGL">FSharp.FGL</a></li>
                <li><a href="https://github.com/CSBiology/BioFSharp.Mz">BioFSharp.Mz</a></li>
            </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/CSBiology/BioFSharp"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
