<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Readers</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="BioFSharp aims to be a user-friendly library for Bioinformatics written in F# as the successor official of FSharpBio."/>
    <meta name="author" content="Timo MÃ¼hlhaus"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>
    <link type="text/css" rel="stylesheet" href="/BioFSharp/style/CSBstyle.css" />
    <link type="text/css" rel="stylesheet" href="/BioFSharp/content/style.css" />
    <script type="text/javascript" src="/BioFSharp/content/tips.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/CSBiology/BioFSharp">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/BioFSharp/index.html">BioFSharp</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<a name="FastA"></a>
<h2><a name="Introducing-FASTA-format" class="anchor" href="#Introducing-FASTA-format">Introducing FASTA format</a></h2>
<br>
<a id="SourceCode" href="https://github.com/CSBiology/BioFSharp/blob/master/src/BioFSharp.IO/FastA.fs">&lt;/&gt;view source code</a>
<a id="Author" href="https://github.com/bvenn">&#128366;view author of this tutorial</a>
<br><br>
<p>The FASTA format can be used to represent sequences of amino acids or nucleotides written in single-letter code
(for further description of single-letter codes visit <a href="https://csbiology.github.io/BioFSharp/reference/biofsharp-nucleotides-nucleotide.html">Nucleotides</a> or <a href="https://csbiology.github.io/BioFSharp/reference/biofsharp-aminoacids-aminoacid.html">AminoAcids</a> respectively).
One sequence constists of two parts: The first line (Header) starting with a "&gt;" is followed by a sequence identification code which should represent a unique description of the sequence.
Subsequent lines contain the sequence itself, which is separated into chunks of 60 to 80 characters per line.
For further information about the format please visit <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&amp;PAGE_TYPE=BlastDocs&amp;DOC_TYPE=BlastHelp">NCBI - FASTA</a>.</p>
<p>Sequences in FASTA format are implemented as a record type containing the following fields:
<br><br></p>
<div id="responsiveTable">
<table>
<thead>
<tr class="header">
<th><p>Field name</p></th>
<th><p>type</p></th>
<th><p>Description</p></th>
<th><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Header</p></td>
<td><p><code>string</code></p></td>
<td><p>sequence identification code</p></td>
<td><p>"gi&amp;#124;0000&amp;#124;gb&amp;#124;accession&amp;#124;0001&amp;#124; example sequence"</p></td>
</tr>
<tr class="even">
<td><p>Sequence</p></td>
<td><p><code>'a</code></p></td>
<td><p>Sequence of nucleotides or aminoacids in type of choice</p></td>
<td><p>BioArray.BioArray<AminoAcids.AminoAcid></p></td>
</tr>
</tbody>
</table>

</div>
<br>>
<h2><a name="Creating-an-FastaItem" class="anchor" href="#Creating-an-FastaItem">Creating an FastaItem</a></h2>
<p>To create a FastaItem type you directly can use the provided <code>create</code> function.
<br></p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span class="i">BioFSharp</span><span class="o">.</span><span class="i">IO</span><span class="o">.</span><span class="i">FastA</span>

<span class="c">//creates a FastaItem out of a header and a sequence in given type</span>
<span class="k">let</span> <span class="i">exampleFasta</span> <span class="o">=</span> <span class="i">FastA</span><span class="o">.</span><span class="i">createFastaItem</span> <span class="s">&quot;gi|0000|gb|accession|0001| example sequence&quot;</span> ([|<span class="s">&#39;M&#39;</span>;<span class="s">&#39;F&#39;</span>;<span class="s">&#39;H&#39;</span>;<span class="s">&#39;F&#39;</span>;<span class="s">&#39;I&#39;</span>;<span class="s">&#39;L&#39;</span>;<span class="s">&#39;P&#39;</span>;<span class="s">&#39;F&#39;</span>;<span class="s">&#39;T&#39;</span>|] <span class="o">|&gt;</span> <span class="i">BioArray</span><span class="o">.</span><span class="i">ofAminoAcidString</span>)
</code></pre></td>
</tr>
</table>
<br>
<h2><a name="Reading-FastaItem" class="anchor" href="#Reading-FastaItem">Reading FastaItem</a></h2>
<p>You can convert the sequence of <code>chars</code> to predefined sequences of <code>AminoAcids</code> or <code>Nucleotides</code>, using converter function
from our library <a href="https://github.com/CSBiology/BioFSharp/blob/master/src/BioFSharp/BioList.fs">BioFSharp.BioList</a>,
<a href="https://github.com/CSBiology/BioFSharp/blob/master/src/BioFSharp/BioArray.fs">BioFSharp.BioArray</a>
or <a href="https://github.com/CSBiology/BioFSharp/blob/master/src/BioFSharp/BioSeq.fs">BioFSharp.BioSeq</a>.</p>
<h4><a name="There-are-multiple-options-to-read-in-a-FASTA-file" class="anchor" href="#There-are-multiple-options-to-read-in-a-FASTA-file">There are multiple options to read in a FASTA file:</a></h4>
<ol>
<li>You can read in the <code>.fasta</code> with the path of the file.</li>
</ol>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span class="i">filepathFASTA</span> <span class="o">=</span> (<span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;/data/FASTAExample1.fasta&quot;</span>)

<span class="c">//reads from file to an array of FastaItems.</span>
<span class="k">let</span> <span class="i">exampleFromFile</span> <span class="o">=</span> <span class="i">FastA</span><span class="o">.</span><span class="i">fromFile</span> <span class="i">BioArray</span><span class="o">.</span><span class="i">ofAminoAcidString</span> <span class="i">filepathFASTA</span>
</code></pre></td>
</tr>
</table>
<br>
2. If the FASTA file is compressed in a gzip file you can read it using the same parameters as above and the following function.
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span class="i">filepathGzipFASTA</span> <span class="o">=</span> (<span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;/data/FASTAExample2.gz&quot;</span>)

<span class="c">//reads from gzip file to an List of FastaItems.</span>
<span class="k">let</span> <span class="i">exampleFromGzipFile</span>  <span class="o">=</span> <span class="i">FastA</span><span class="o">.</span><span class="i">fromGzipFile</span> <span class="i">BioList</span><span class="o">.</span><span class="i">ofAminoAcidString</span> <span class="i">filepathGzipFASTA</span>
</code></pre></td>
</tr>
</table>
<br>
3. To convert `seq<string>` to `seq<FastaItem>` you can use the following function.
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span class="i">FSharp</span><span class="o">.</span><span class="i">Care</span><span class="o">.</span><span class="i">IO</span>

<span class="k">let</span> <span class="i">stringSequence</span> <span class="o">=</span> <span class="i">FileIO</span><span class="o">.</span><span class="i">readFile</span>(<span class="i">filepathFASTA</span>)

<span class="c">//reads seq&lt;string&gt; to sequence of FastaItems</span>
<span class="k">let</span> <span class="i">exampleFromFileEnumerator</span> <span class="o">=</span> <span class="i">FastA</span><span class="o">.</span><span class="i">fromFileEnumerator</span> <span class="i">BioSeq</span><span class="o">.</span><span class="i">ofAminoAcidString</span> <span class="i">stringSequence</span>
</code></pre></td>
</tr>
</table>
<br>
To write a `seq<FastaItem>` into a file use the following function.
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span class="i">seqFastaItem</span> <span class="o">=</span> <span class="i">seq</span> [<span class="i">exampleFasta</span>]

<span class="c">//writes a sequence of FastaItems into a .fasta file</span>
<span class="i">FastA</span><span class="o">.</span><span class="i">write</span> <span class="i">BioItem</span><span class="o">.</span><span class="i">symbol</span> (<span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;/data/FASTAExample3.fasta&quot;</span>) <span class="i">seqFastaItem</span> 
</code></pre></td>
</tr>
</table>


        </div>
        <div class="span3" >
          <img src="/BioFSharp/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
            <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
                <li class="nav-header">BioFSharp</li>
                <li><a href="/BioFSharp/index.html">Home page</a></li>
                <li class="divider"></li>
                <li><a href="/BioFSharp/Introduction.html">Getting started</a></li>

                
                <li class="nav-header">BioFSharp core</li>
                <li><a href="/BioFSharp/Formula.html">Formula</a></li>
                <li>
                    <a href="/BioFSharp/BioItem.html">BioItems</a>
                </li>
                <li>
                    <a href="/BioFSharp/BioCollections.html">BioCollections</a>
                </li>
                <li><a href="/BioFSharp/AminoProperties.html">Peptide Properties</a></li>
                <li class="nav-header">Algorithm</li>
                <li><a href="/BioFSharp/Alignment.html">Alignment</a></li>
                <li><a href="/BioFSharp/MotiveSearch.html">Motive search</a></li>
                <li><a href="/BioFSharp/BlastWrapper.html">NCBI-Blast</a></li>
                <li>
                    <a href="/BioFSharp/StringMatching.html">Pattern Queries</a>
                </li>
                <li class="nav-header">File I/O</li>
                <li><a href="/BioFSharp/FastA.html">FastA</a></li>
                <li><a href="/BioFSharp/FastQ.html">FastQ</a></li>
                <li><a href="/BioFSharp/GFF3.html">GFF format</a></li>
                <li><a href="/BioFSharp/GenBank.html">GenBank</a></li>
                <li>
                    <a href="/BioFSharp/Clustal.html">Clustal</a>
                </li>        
                <li>
                    <a href="/BioFSharp/Newick.html">Newick</a>
                </li>                
                <li><a href="/BioFSharp/Obo.html">Obo ontology format</a></li>
                <li><a href="/BioFSharp/CSV.html">Delimited files</a></li>
                <li class="nav-header">Web I/O</li>
                <li><a href="/BioFSharp/UniProt.html">UniProt</a></li>
                <li><a href="/BioFSharp/BioDB.html">BioDB</a></li>
                <li class="nav-header">Biostatistics</li>
                <li><a href="/BioFSharp/GESA.html">Ontology enrichment</a></li>
                <li class="nav-header">Biovisualization</li>
                <li><a href="/BioFSharp/WebLogo.html">Web logo</a></li>
                
                <li class="nav-header">Documentation</li>
                <li><a href="/BioFSharp/reference/index.html">API Reference</a></li>


                
            </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/CSBiology/BioFSharp"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
