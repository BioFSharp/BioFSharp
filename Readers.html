<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Readers</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="An open source bioinformatics toolbox written in F#. <https://csbiology.github.io/BioFSharp/>"/>
    <meta name="author" content="Timo MÃ¼hlhaus"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>
    <meta http-equiv="X-UA-Compatible" content="IE=11" >
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link type="text/css" rel="stylesheet" href="/BioFSharp/content/style.css" /> <!--/BioFSharp-->
    <link type="text/css" rel="stylesheet" href="/BioFSharp/style/CSBstyle.css" /> <!--/BioFSharp-->
    <script type="text/javascript" src="/BioFSharp/content/tips.js"></script> <!--/BioFSharp-->
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
	<body>
		<div class="container">
		  <div class="masthead">
			<ul class="nav nav-pills pull-right">
			  <li><a href="http://fsharp.org">fsharp.org</a></li>
			  <li><a href="https://github.com/CSBiology/BioFSharp">github page</a></li>
			</ul>
			<h3 class="muted"><a href="/BioFSharp/index.html">BioFSharp</a></h3>
		  </div>
		  <hr />
		  <div class="row">
			<div class="span9" id="main">
			  
<a name="FastA"></a>
<h2><a name="Introducing-FASTA-format" class="anchor" href="#Introducing-FASTA-format">Introducing FASTA format</a></h2>
<br>
<a id="SourceCode" href="https://github.com/CSBiology/BioFSharp/blob/master/src/BioFSharp.IO/FastA.fs">&lt;/&gt;view source code</a>
<a id="Author" href="https://github.com/bvenn">&#128366;view author of this tutorial</a>
<br><br>
<p>The FASTA format can be used to represent sequences of amino acids or nucleotides written in single-letter code
(for further description of single-letter codes visit <a href="https://csbiology.github.io/BioFSharp/reference/biofsharp-nucleotides-nucleotide.html">Nucleotides</a> or <a href="https://csbiology.github.io/BioFSharp/reference/biofsharp-aminoacids-aminoacid.html">AminoAcids</a> respectively).
One sequence constists of two parts: The first line (Header) starting with a "&gt;" is followed by a sequence identification code which should represent a unique description of the sequence.
Subsequent lines contain the sequence itself, which is separated into chunks of 60 to 80 characters per line.
For further information about the format please visit <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Web&amp;PAGE_TYPE=BlastDocs&amp;DOC_TYPE=BlastHelp">NCBI - FASTA</a>.</p>
<p>Sequences in FASTA format are implemented as a record type containing the following fields:
<br><br></p>
<div id="responsiveTable">
<table>
<thead>
<tr class="header">
<th><p>Field name</p></th>
<th><p>type</p></th>
<th><p>Description</p></th>
<th><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Header</p></td>
<td><p><code>string</code></p></td>
<td><p>sequence identification code</p></td>
<td><p>"gi&#124;0000&#124;gb&#124;accession&#124;0001&#124; example sequence"</p></td>
</tr>
<tr class="even">
<td><p>Sequence</p></td>
<td><p><code>'a</code></p></td>
<td><p>Sequence of nucleotides or aminoacids in type of choice</p></td>
<td><p>BioArray.BioArray<AminoAcids.AminoAcid></p></td>
</tr>
</tbody>
</table>

</div>
<br>>
<h2><a name="Creating-an-FastaItem" class="anchor" href="#Creating-an-FastaItem">Creating an FastaItem</a></h2>
<p>To create a FastaItem type you directly can use the provided <code>create</code> function.
<br></p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 6)" onmouseover="showTip(event, 'fs1', 6)" class="id">BioFSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 7)" onmouseover="showTip(event, 'fs2', 7)" class="id">IO</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="id">FastA</span>

<span class="c">//creates a FastaItem out of a header and a sequence in given type</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 9)" onmouseover="showTip(event, 'fs6', 9)" class="id">exampleFasta</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 10)" onmouseover="showTip(event, 'fs5', 10)" class="m">FastA</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 11)" onmouseover="showTip(event, 'fs7', 11)" class="id">createFastaItem</span> <span class="s">&quot;gi|0000|gb|accession|0001| example sequence&quot;</span> <span class="pn">(</span><span class="pn">[|</span><span class="s">&#39;M&#39;</span><span class="pn">;</span><span class="s">&#39;F&#39;</span><span class="pn">;</span><span class="s">&#39;H&#39;</span><span class="pn">;</span><span class="s">&#39;F&#39;</span><span class="pn">;</span><span class="s">&#39;I&#39;</span><span class="pn">;</span><span class="s">&#39;L&#39;</span><span class="pn">;</span><span class="s">&#39;P&#39;</span><span class="pn">;</span><span class="s">&#39;F&#39;</span><span class="pn">;</span><span class="s">&#39;T&#39;</span><span class="pn">|]</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs8', 12)" onmouseover="showTip(event, 'fs8', 12)" class="m">BioArray</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="id">ofAminoAcidString</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<br>
<h2><a name="Reading-FastaItem" class="anchor" href="#Reading-FastaItem">Reading FastaItem</a></h2>
<p>You can convert the sequence of <code>chars</code> to predefined sequences of <code>AminoAcids</code> or <code>Nucleotides</code>, using converter function
from our library <a href="https://github.com/CSBiology/BioFSharp/blob/master/src/BioFSharp/BioList.fs">BioFSharp.BioList</a>,
<a href="https://github.com/CSBiology/BioFSharp/blob/master/src/BioFSharp/BioArray.fs">BioFSharp.BioArray</a>
or <a href="https://github.com/CSBiology/BioFSharp/blob/master/src/BioFSharp/BioSeq.fs">BioFSharp.BioSeq</a>.</p>
<h4><a name="There-are-multiple-options-to-read-in-a-FASTA-file" class="anchor" href="#There-are-multiple-options-to-read-in-a-FASTA-file">There are multiple options to read in a FASTA file:</a></h4>
<ol>
<li>You can read in the <code>.fasta</code> with the path of the file.</li>
</ol>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="id">filepathFASTA</span> <span class="o">=</span> <span class="pn">(</span><span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;/data/FASTAExample1.fasta&quot;</span><span class="pn">)</span>

<span class="c">//reads from file to an array of FastaItems.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="id">exampleFromFile</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 16)" onmouseover="showTip(event, 'fs5', 16)" class="m">FastA</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="id">fromFile</span> <span onmouseout="hideTip(event, 'fs8', 18)" onmouseover="showTip(event, 'fs8', 18)" class="m">BioArray</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 19)" onmouseover="showTip(event, 'fs9', 19)" class="id">ofAminoAcidString</span> <span onmouseout="hideTip(event, 'fs10', 20)" onmouseover="showTip(event, 'fs10', 20)" class="id">filepathFASTA</span>
</code></pre></td>
</tr>
</table>
<br>
2. If the FASTA file is compressed in a gzip file you can read it using the same parameters as above and the following function.
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 21)" onmouseover="showTip(event, 'fs13', 21)" class="id">filepathGzipFASTA</span> <span class="o">=</span> <span class="pn">(</span><span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;/data/FASTAExample2.gz&quot;</span><span class="pn">)</span>

<span class="c">//reads from gzip file to an List of FastaItems.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 22)" onmouseover="showTip(event, 'fs14', 22)" class="id">exampleFromGzipFile</span>  <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 23)" onmouseover="showTip(event, 'fs5', 23)" class="m">FastA</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs15', 24)" onmouseover="showTip(event, 'fs15', 24)" class="id">fromGzipFile</span> <span onmouseout="hideTip(event, 'fs16', 25)" onmouseover="showTip(event, 'fs16', 25)" class="m">BioList</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs17', 26)" onmouseover="showTip(event, 'fs17', 26)" class="id">ofAminoAcidString</span> <span onmouseout="hideTip(event, 'fs13', 27)" onmouseover="showTip(event, 'fs13', 27)" class="id">filepathGzipFASTA</span>
</code></pre></td>
</tr>
</table>
<br>
3. To convert `seq<string>` to `seq<FastaItem>` you can use the following function.
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 28)" onmouseover="showTip(event, 'fs18', 28)" class="id">stringSequence</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 29)" onmouseover="showTip(event, 'fs19', 29)" class="m">FileIO</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 30)" onmouseover="showTip(event, 'fs20', 30)" class="id">readFile</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs10', 31)" onmouseover="showTip(event, 'fs10', 31)" class="id">filepathFASTA</span><span class="pn">)</span>

<span class="c">//reads seq&lt;string&gt; to sequence of FastaItems</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 32)" onmouseover="showTip(event, 'fs21', 32)" class="id">exampleFromFileEnumerator</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 33)" onmouseover="showTip(event, 'fs5', 33)" class="m">FastA</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs22', 34)" onmouseover="showTip(event, 'fs22', 34)" class="id">fromFileEnumerator</span> <span onmouseout="hideTip(event, 'fs23', 35)" onmouseover="showTip(event, 'fs23', 35)" class="m">BioSeq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs24', 36)" onmouseover="showTip(event, 'fs24', 36)" class="id">ofAminoAcidString</span> <span onmouseout="hideTip(event, 'fs18', 37)" onmouseover="showTip(event, 'fs18', 37)" class="id">stringSequence</span>
</code></pre></td>
</tr>
</table>
<br>
To write a `seq<FastaItem>` into a file use the following function.
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 38)" onmouseover="showTip(event, 'fs25', 38)" class="id">seqFastaItem</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs26', 39)" onmouseover="showTip(event, 'fs26', 39)" class="k">seq</span> <span class="pn">[</span><span onmouseout="hideTip(event, 'fs6', 40)" onmouseover="showTip(event, 'fs6', 40)" class="id">exampleFasta</span><span class="pn">]</span>

<span class="c">//writes a sequence of FastaItems into a .fasta file</span>
</code></pre></td>
</tr>
</table>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs5', 41)" onmouseover="showTip(event, 'fs5', 41)" class="m">FastA</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs27', 42)" onmouseover="showTip(event, 'fs27', 42)" class="id">write</span> <span onmouseout="hideTip(event, 'fs28', 43)" onmouseover="showTip(event, 'fs28', 43)" class="m">BioItem</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs29', 44)" onmouseover="showTip(event, 'fs29', 44)" class="id">symbol</span> <span class="pn">(</span><span class="k">__SOURCE_DIRECTORY__</span> <span class="o">+</span> <span class="s">&quot;/data/FASTAExample3.fasta&quot;</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs25', 45)" onmouseover="showTip(event, 'fs25', 45)" class="id">seqFastaItem</span> 
</code></pre></td>
</tr>
</table>

<div class="tip" id="fs1">namespace BioFSharp</div>
<div class="tip" id="fs2">namespace BioFSharp.IO</div>
<div class="tip" id="fs3">namespace FSharpAux</div>
<div class="tip" id="fs4">namespace FSharpAux.IO</div>
<div class="tip" id="fs5">module FastA<br /><br />from BioFSharp.IO</div>
<div class="tip" id="fs6">val exampleFasta : FastaItem&lt;BioArray.BioArray&lt;AminoAcids.AminoAcid&gt;&gt;</div>
<div class="tip" id="fs7">val createFastaItem : header:string -&gt; sequence:&#39;a -&gt; FastaItem&lt;&#39;a&gt;</div>
<div class="tip" id="fs8">module BioArray<br /><br />from BioFSharp</div>
<div class="tip" id="fs9">val ofAminoAcidString : s:#seq&lt;char&gt; -&gt; BioArray.BioArray&lt;AminoAcids.AminoAcid&gt;</div>
<div class="tip" id="fs10">val filepathFASTA : string</div>
<div class="tip" id="fs11">val exampleFromFile : seq&lt;FastaItem&lt;BioArray.BioArray&lt;AminoAcids.AminoAcid&gt;&gt;&gt;</div>
<div class="tip" id="fs12">val fromFile : converter:(seq&lt;char&gt; -&gt; &#39;a) -&gt; filePath:string -&gt; seq&lt;FastaItem&lt;&#39;a&gt;&gt;</div>
<div class="tip" id="fs13">val filepathGzipFASTA : string</div>
<div class="tip" id="fs14">val exampleFromGzipFile : seq&lt;FastaItem&lt;BioList.BioList&lt;AminoAcids.AminoAcid&gt;&gt;&gt;</div>
<div class="tip" id="fs15">val fromGzipFile : converter:(seq&lt;char&gt; -&gt; &#39;a) -&gt; filePath:string -&gt; seq&lt;FastaItem&lt;&#39;a&gt;&gt;</div>
<div class="tip" id="fs16">module BioList<br /><br />from BioFSharp</div>
<div class="tip" id="fs17">val ofAminoAcidString : s:#seq&lt;char&gt; -&gt; BioList.BioList&lt;AminoAcids.AminoAcid&gt;</div>
<div class="tip" id="fs18">val stringSequence : seq&lt;string&gt;</div>
<div class="tip" id="fs19">module FileIO<br /><br />from FSharpAux.IO</div>
<div class="tip" id="fs20">val readFile : file:string -&gt; seq&lt;string&gt;</div>
<div class="tip" id="fs21">val exampleFromFileEnumerator : seq&lt;FastaItem&lt;BioSeq.BioSeq&lt;AminoAcids.AminoAcid&gt;&gt;&gt;</div>
<div class="tip" id="fs22">val fromFileEnumerator : converter:(seq&lt;char&gt; -&gt; &#39;a) -&gt; fileEnumerator:seq&lt;string&gt; -&gt; seq&lt;FastaItem&lt;&#39;a&gt;&gt;</div>
<div class="tip" id="fs23">module BioSeq<br /><br />from BioFSharp</div>
<div class="tip" id="fs24">val ofAminoAcidString : s:#seq&lt;char&gt; -&gt; BioSeq.BioSeq&lt;AminoAcids.AminoAcid&gt;</div>
<div class="tip" id="fs25">val seqFastaItem : seq&lt;FastaItem&lt;BioArray.BioArray&lt;AminoAcids.AminoAcid&gt;&gt;&gt;</div>
<div class="tip" id="fs26">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = System.Collections.Generic.IEnumerable&lt;&#39;T&gt;</div>
<div class="tip" id="fs27">val write : toString:(&#39;T -&gt; char) -&gt; filePath:string -&gt; data:seq&lt;FastaItem&lt;#seq&lt;&#39;T&gt;&gt;&gt; -&gt; unit</div>
<div class="tip" id="fs28">module BioItem<br /><br />from BioFSharp</div>
<div class="tip" id="fs29">val symbol : bItem:#IBioItem -&gt; char</div>

			</div>
			<div class="span3" >
			  <img src="/BioFSharp/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
              <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
                  <li class="nav-header">BioFSharp</li>
                  <li><a href="/BioFSharp/index.html">Home page</a></li>
                  <li class="divider"></li>
                  <li><a href="/BioFSharp/release-notes.html">Release Notes</a></li>
                  <li><a href="/BioFSharp/Introduction.html">Getting started</a></li>

                  
                  <li class="nav-header">BioFSharp core</li>
                  <li><a href="/BioFSharp/Formula.html">Formula</a></li>
                  <li>
                      <a href="/BioFSharp/BioItem.html">BioItems</a>
                  </li>
                  <li><a href="/BioFSharp/BioCollections.html">BioCollections</a></li>
                  <li><a href="/BioFSharp/AminoProperties.html">Peptide Properties</a></li>
                  <li class="nav-header">BioContainers</li>
                  <li><a href="/BioFSharp/BioContainers.html">Introduction</a></li>
                  <li><a href="/BioFSharp/BioContainersDesignGuide.html">Container API Design Guide</a></li>
                  <li class="nav-header">Algorithm</li>
                  <li><a href="/BioFSharp/Alignment.html">Alignment</a></li>
                  <li><a href="/BioFSharp/ClustalOWrapper.html">Clustal Omega</a></li>
                  <li><a href="/BioFSharp/MotiveSearch.html">Motive search</a></li>
                  <li><a href="/BioFSharp/BlastWrapper.html">NCBI-Blast</a></li>
                  <li>
                      <a href="/BioFSharp/StringMatching.html">Pattern Queries</a>
                  </li>
                  <li class="nav-header">File I/O</li>
                  <li>
                      <a href="/BioFSharp/Clustal.html">Clustal</a>
                  </li>
                  <li><a href="/BioFSharp/CSV.html">CSV / Tabular</a></li>
                  <li>
                      <a href="/BioFSharp/FastA.html">FastA</a>
                  </li>
                  <li><a href="/BioFSharp/FastQ.html">FastQ</a></li>
                  <li>
                      <a href="/BioFSharp/GenBank.html">GenBank</a>
                  </li>
                  <li>
                      <a href="/BioFSharp/GFF3.html">GFF3</a>
                  </li>
                  <li>
                      <a href="/BioFSharp/Newick.html">Newick</a>
                  </li>
                  <li><a href="/BioFSharp/Obo.html">Obo ontology format</a></li>
                  <li>
                      <a href="/BioFSharp/FSIPrinters.html">FSIPrinters</a>
                  </li>
                  <li class="nav-header">Web I/O</li>
                  <li><a href="/BioFSharp/UniProt.html">UniProt</a></li>
                  <li><a href="/BioFSharp/BioDB.html">BioDB</a></li>
                  <li class="nav-header">Biostatistics</li>
                  <li><a href="/BioFSharp/GSEA.html">Ontology enrichment</a></li>
                  <li class="nav-header">Biovisualization</li>
                  <li><a href="/BioFSharp/WebLogo.html">Web logo</a></li>
                  <li class="nav-header">GPU Computing</li>
                  <li><a href="/BioFSharp/ParallelAlignment.html">Sequence Alignment</a></li>
                  <li class="nav-header">Documentation</li>
                  <li><a href="/BioFSharp/reference/index.html">API Reference</a></li>


                  
              </ul>
			</div>
		  </div>
		</div>
		<a href="https://github.com/CSBiology/BioFSharp"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
	  </body>
  </html>
